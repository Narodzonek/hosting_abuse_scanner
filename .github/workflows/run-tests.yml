name: ğŸ§ª Test Suite - Hosting Abuse Scanner

# Kiedy uruchamiaÄ‡ testy
on:
  push:                    # Przy kaÅ¼dym push'u
    branches: [ main ]     # Do gaÅ‚Ä™zi main
  pull_request:           # Przy tworzeniu Pull Request
    branches: [ main ]    # Do gaÅ‚Ä™zi main

# Zadania do wykonania
jobs:
  test:
    name: ğŸš€ Run Tests
    runs-on: ubuntu-latest  # Na najnowszej wersji Ubuntu
    
    steps:
    # Krok 1: Pobierz kod z repozytorium
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    # Krok 2: Zainstaluj bats-core
    - name: ğŸ“¦ Install bats-core
      run: |
        sudo apt-get update
        sudo apt-get install -y bats
        
    # Krok 3: SprawdÅº czy skrypt jest wykonywalny
    - name: ğŸ”§ Make scanner executable
      run: |
        chmod +x abuse_scanner.sh
        ls -la abuse_scanner.sh
        
    # Krok 4: Uruchom testy
    - name: ğŸ§ª Run tests
      run: |
        cd tests
        bats test.bats
        
    # Krok 5: Uruchom testy z verbose (tylko jeÅ›li poprzednie failowaÅ‚y)
    - name: ğŸ” Run tests with verbose output
      if: failure()
      run: |
        cd tests
        bats test.bats --verbose
        
    # Krok 6: SprawdÅº czy wszystkie pliki testowe istniejÄ…
    - name: ğŸ“‹ Verify test files
      run: |
        ls -la tests/
        echo "Test files:"
        find tests/ -name "*.bats" -type f
